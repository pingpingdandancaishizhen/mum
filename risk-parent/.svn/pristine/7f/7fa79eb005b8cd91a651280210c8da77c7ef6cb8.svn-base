<template>
  <div>
    <div class="row-right" :class="(oData[data.dataSource]&&oData[data.dataSource].length>4)?'col-sm-12':(!checkedAdd?'col-sm-6':'col-sm-3')">
      <div class="form-group input-group " :id="data.key">
        <label class="label-head label-head-lg label-head-top  text-right"  v-if="!checkedAdd"><span :class="data.required?'require':''">{{data.label}}:</span></label>
        <div class="label-box">
          <label class="radio-inline" v-if="oData[data.dataSource]" v-for="item in oData[data.dataSource]">
            <input type="radio" :name="data.key" :value="item.dicKey" v-model="checkRadio"
                   :disabled="data.readonly?true:false">{{item.dicValue}}
          </label>
          <div class="form-error-tip">{{errorMsg[data.key]}}</div>
        </div>
      </div>
    </div>
    <component :is="currentView" :data="data.extGroups[checkRadio]" keep-alive class="inner-panel"></component>
  </div>


</template>
<style>

</style>
<script>
  import checkRule from '../mixins/checkRule'
  export default{
    mixins:[checkRule],
    data(){
      return {
        checkRadio: '',
        currentView: 'app-form'
      }
    },
    props: ['data', 'oData', 'attrsData', 'checkedAdd'],
    created: function () {
      this.$store.dispatch('setInputData', {key: this.data.key, value: ''})
    },
    watch: {
      checkRadio: function (val) {
        var extGroups = this.data.extGroups;
        if (extGroups[val]) {
          this.currentView = 'app-form'
        } else {
          this.currentView = ''
        }
        var valData={};
        valData[this.data.key]=val;
        this.checkRuleValue=Object.assign({},this.checkRuleValue,valData);
        this.$store.dispatch('setInputData', {key: this.data.key, value: val})
      }
    },
    mounted: function () {
      var attrValue = this.attrsData[this.data.key];
      var slectData = attrValue ? (attrValue.draftValue == null ? (attrValue.attrValue || '') : attrValue.draftValue) : '';
      /*slectData!=''&&this.$store.dispatch('setInputData', {key: this.data.key, value: slectData});*/
      this.checkRadio = slectData
    },
    beforeCreate: function () {
      this.$options.components['app-form'] = require('./form.vue');
    },
  }
</script>
